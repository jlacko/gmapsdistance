---
title: "gmapsdistance package in use"
author: "Jindra Lacko"
date: "2022-08-30"
output:
  rmarkdown::html_vignette:
    toc: true
self_contained: no
vignette: >
  %\VignetteIndexEntry{Examples of using `{gmapsdistance}` package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---



## Setting up API key
The [Google Distance Matrix API](https://mapsplatform.google.com/) requires registration, and an API key is required in each function call. It is possible to store the key for duration of a R session by using `gmapsdistance::set.api.key()` call.

Note that in order to keep the maintainers API key private it has been stored locally in an environment variable; in the most frequent use cases it can be used in plain text.


```r
library(gmapsdistance)
set.api.key(Sys.getenv("GOOGLE_API_KEY"))
```

## Distance between cities
In this example we will compute the driving distance between Washington DC, and New York City. The code returns the `Time`, the `Distance` and the `Status` of the query (`OK` if it was successful). The calculation will be made using the "driving" method, which is the default.


```r
results = gmapsdistance(origin = "Washington DC",
                        destination = "New York City NY")
results
## $Distance
## [1] 361961
## 
## $Time
## [1] 15524
## 
## $Status
## [1] "OK"
```

## Walking distance between GPS coordinates
In this example we will compute the driving distance between the Greek cities of
Marathon and Athens. We show that the function is able to handle LAT-LONG coordinates.


```r
results = gmapsdistance(origin = "38.1621328 24.0029257",
                        destination = "37.9908372 23.7383394",
                        mode = "walking")
results
## $Distance
## [1] 39459
## 
## $Time
## [1] 29929
## 
## $Status
## [1] "OK"
```

## Distance matrix at a specific departure time
This example computes the travel distance and time matrices between two vectors of cities at a specific departure time

```r
results = gmapsdistance(origin = c("Washington DC", "New York NY",
                                   "Seattle WA", "Miami FL"),
                        destination = c("Los Angeles CA", "Austin TX",
                                        "Chicago IL", "Philadelphia PA"),
                        mode = "bicycling",
                        # departure time as seconds from Unix Epoch (1970-01-01)
                        departure = 1690682400)
results
## $Distance
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC        4530310   2564839    1248646          230081
## New York NY          4864544   3155243    1474289          159383
## Seattle WA           1970458   3588907    3471263         4814940
## Miami FL             4547832   2307421    2357058         2140028
## 
## $Time
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC         846180    476863     243696           45691
## New York NY           910628    601558     290960           31430
## Seattle WA            366549    662136     640376          902008
## Miami FL              824165    417918     439225          396622
## 
## $Status
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC "OK"           "OK"      "OK"       "OK"           
## New York NY   "OK"           "OK"      "OK"       "OK"           
## Seattle WA    "OK"           "OK"      "OK"       "OK"           
## Miami FL      "OK"           "OK"      "OK"       "OK"
# Equivalently
results = gmapsdistance(origin = c("Washington DC", "New York NY",
                                   "Seattle WA", "Miami FL"),
                        destination = c("Los Angeles CA", "Austin TX",
                                        "Chicago IL", "Philadelphia PA"),
                        mode = "bicycling",
                        dep_date = "2023-07-30",
                        dep_time = "20:40:00")

results
## $Distance
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC        4530310   2564839    1248646          230081
## New York NY          4864544   3155243    1474289          159383
## Seattle WA           1970458   3588907    3471263         4814940
## Miami FL             4547832   2307421    2357058         2140028
## 
## $Time
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC         846180    476863     243696           45691
## New York NY           910628    601558     290960           31430
## Seattle WA            366549    662136     640376          902008
## Miami FL              824165    417918     439225          396622
## 
## $Status
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC "OK"           "OK"      "OK"       "OK"           
## New York NY   "OK"           "OK"      "OK"       "OK"           
## Seattle WA    "OK"           "OK"      "OK"       "OK"           
## Miami FL      "OK"           "OK"      "OK"       "OK"
```

## Long format of distance matrix
This example computes the travel distance and time matrices between two vectors of cities and return the results in long format

```r
origin = c("Washington DC", "New York NY", "Seattle WA", "Miami FL")
destination = c("Los Angeles CA", "Austin TX", "Chicago IL")

results = gmapsdistance(origin,
                        destination,
                        mode = "driving",
                        shape = "long")

results
## $Distance
##               or             de Distance
## 1  Washington DC Los Angeles CA  4295007
## 2    New York NY Los Angeles CA  4489116
## 3     Seattle WA Los Angeles CA  1829362
## 4       Miami FL Los Angeles CA  4400701
## 5  Washington DC      Austin TX  2451874
## 6    New York NY      Austin TX  2806295
## 7     Seattle WA      Austin TX  3409435
## 8       Miami FL      Austin TX  2171447
## 9  Washington DC     Chicago IL  1126224
## 10   New York NY     Chicago IL  1271459
## 11    Seattle WA     Chicago IL  3321590
## 12      Miami FL     Chicago IL  2226792
## 
## $Time
##               or             de   Time
## 1  Washington DC Los Angeles CA 140445
## 2    New York NY Los Angeles CA 148464
## 3     Seattle WA Los Angeles CA  63876
## 4       Miami FL Los Angeles CA 141196
## 5  Washington DC      Austin TX  81370
## 6    New York NY      Austin TX  94904
## 7     Seattle WA      Austin TX 117229
## 8       Miami FL      Austin TX  70176
## 9  Washington DC     Chicago IL  39752
## 10   New York NY     Chicago IL  44571
## 11    Seattle WA     Chicago IL 107397
## 12      Miami FL     Chicago IL  72513
## 
## $Status
##               or             de status
## 1  Washington DC Los Angeles CA     OK
## 2    New York NY Los Angeles CA     OK
## 3     Seattle WA Los Angeles CA     OK
## 4       Miami FL Los Angeles CA     OK
## 5  Washington DC      Austin TX     OK
## 6    New York NY      Austin TX     OK
## 7     Seattle WA      Austin TX     OK
## 8       Miami FL      Austin TX     OK
## 9  Washington DC     Chicago IL     OK
## 10   New York NY     Chicago IL     OK
## 11    Seattle WA     Chicago IL     OK
## 12      Miami FL     Chicago IL     OK
```

## Distance matrix between GPS coordinates
This example computes the travel distance and time between two vectors of cities defined as LAT-LONG coordinates.


```r
origin = c("40.431478 -80.0505401", "33.7678359 -84.4906438")
destination = c("43.0995629 -79.0437609", "41.7096483 -86.9093986")

results = gmapsdistance(origin,
                        destination,
                        mode="bicycling",
                        shape="long")

results
## $Distance
##                       or                     de Distance
## 1  40.431478 -80.0505401 43.0995629 -79.0437609   417779
## 2 33.7678359 -84.4906438 43.0995629 -79.0437609  1529176
## 3  40.431478 -80.0505401 41.7096483 -86.9093986   704112
## 4 33.7678359 -84.4906438 41.7096483 -86.9093986  1114453
## 
## $Time
##                       or                     de   Time
## 1  40.431478 -80.0505401 43.0995629 -79.0437609  78758
## 2 33.7678359 -84.4906438 43.0995629 -79.0437609 290012
## 3  40.431478 -80.0505401 41.7096483 -86.9093986 131437
## 4 33.7678359 -84.4906438 41.7096483 -86.9093986 209954
## 
## $Status
##                       or                     de status
## 1  40.431478 -80.0505401 43.0995629 -79.0437609     OK
## 2 33.7678359 -84.4906438 43.0995629 -79.0437609     OK
## 3  40.431478 -80.0505401 41.7096483 -86.9093986     OK
## 4 33.7678359 -84.4906438 41.7096483 -86.9093986     OK
```

## Combination of distances
This example computes the travel distance and time between two vectors of cities using the 'combinations' option.


```r
# 1. Pairwise

or = c("Washington DC", "New York NY", "Seattle WA", "Miami FL")
des = c("Los Angeles CA", "Austin TX", "Chicago IL", "Philadelphia PA")

results = gmapsdistance(origin = or,
                        destination = des,
                        mode = "bicycling",
                        combinations = "pairwise")
results
## $Distance
##              or              de Distance
## 1 Washington DC  Los Angeles CA  4530310
## 2   New York NY       Austin TX  3155243
## 3    Seattle WA      Chicago IL  3471263
## 4      Miami FL Philadelphia PA  2140028
## 
## $Time
##              or              de   Time
## 1 Washington DC  Los Angeles CA 846180
## 2   New York NY       Austin TX 601558
## 3    Seattle WA      Chicago IL 640376
## 4      Miami FL Philadelphia PA 396622
## 
## $Status
##              or              de status
## 1 Washington DC  Los Angeles CA     OK
## 2   New York NY       Austin TX     OK
## 3    Seattle WA      Chicago IL     OK
## 4      Miami FL Philadelphia PA     OK

# 2. All combinations of origins and destinations in wide format
results = gmapsdistance(origin = or,
                        destination = des,
                        mode = "bicycling",
                        combinations = "all",
                        shape = "wide")
results
## $Distance
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC        4530310   2564839    1248646          230081
## New York NY          4864544   3155243    1474289          159383
## Seattle WA           1970458   3588907    3471263         4814940
## Miami FL             4547832   2307421    2357058         2140028
## 
## $Time
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC         846180    476863     243696           45691
## New York NY           910628    601558     290960           31430
## Seattle WA            366549    662136     640376          902008
## Miami FL              824165    417918     439225          396622
## 
## $Status
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC "OK"           "OK"      "OK"       "OK"           
## New York NY   "OK"           "OK"      "OK"       "OK"           
## Seattle WA    "OK"           "OK"      "OK"       "OK"           
## Miami FL      "OK"           "OK"      "OK"       "OK"

results = gmapsdistance(origin = or,
                        destination = des,
                        mode = "bicycling",
                        combinations = "all",
                        shape = "long")
results
## $Distance
##               or              de Distance
## 1  Washington DC  Los Angeles CA  4530310
## 2    New York NY  Los Angeles CA  4864544
## 3     Seattle WA  Los Angeles CA  1970458
## 4       Miami FL  Los Angeles CA  4547832
## 5  Washington DC       Austin TX  2564839
## 6    New York NY       Austin TX  3155243
## 7     Seattle WA       Austin TX  3588907
## 8       Miami FL       Austin TX  2307421
## 9  Washington DC      Chicago IL  1248646
## 10   New York NY      Chicago IL  1474289
## 11    Seattle WA      Chicago IL  3471263
## 12      Miami FL      Chicago IL  2357058
## 13 Washington DC Philadelphia PA   230081
## 14   New York NY Philadelphia PA   159383
## 15    Seattle WA Philadelphia PA  4814940
## 16      Miami FL Philadelphia PA  2140028
## 
## $Time
##               or              de   Time
## 1  Washington DC  Los Angeles CA 846180
## 2    New York NY  Los Angeles CA 910628
## 3     Seattle WA  Los Angeles CA 366549
## 4       Miami FL  Los Angeles CA 824165
## 5  Washington DC       Austin TX 476863
## 6    New York NY       Austin TX 601558
## 7     Seattle WA       Austin TX 662136
## 8       Miami FL       Austin TX 417918
## 9  Washington DC      Chicago IL 243696
## 10   New York NY      Chicago IL 290960
## 11    Seattle WA      Chicago IL 640376
## 12      Miami FL      Chicago IL 439225
## 13 Washington DC Philadelphia PA  45691
## 14   New York NY Philadelphia PA  31430
## 15    Seattle WA Philadelphia PA 902008
## 16      Miami FL Philadelphia PA 396622
## 
## $Status
##               or              de status
## 1  Washington DC  Los Angeles CA     OK
## 2    New York NY  Los Angeles CA     OK
## 3     Seattle WA  Los Angeles CA     OK
## 4       Miami FL  Los Angeles CA     OK
## 5  Washington DC       Austin TX     OK
## 6    New York NY       Austin TX     OK
## 7     Seattle WA       Austin TX     OK
## 8       Miami FL       Austin TX     OK
## 9  Washington DC      Chicago IL     OK
## 10   New York NY      Chicago IL     OK
## 11    Seattle WA      Chicago IL     OK
## 12      Miami FL      Chicago IL     OK
## 13 Washington DC Philadelphia PA     OK
## 14   New York NY Philadelphia PA     OK
## 15    Seattle WA Philadelphia PA     OK
## 16      Miami FL Philadelphia PA     OK
```

## Using optional parameters - traffic model and avoidance
This example show the use of traffic model and avoidance parameters, while setting the API key directly in function call.
Note that in order to keep the maintainers API key private it has been stored locally in an environment variable; in the most frequent use cases it can be used in plain text.


```r
APIkey <- Sys.getenv("GOOGLE_API_KEY") # your actual API key would go here...

# Time and distance using a 'pessimistic' traffic model.
results = gmapsdistance(origin = c("Washington DC", "New York NY"),
                        destination = c("Los Angeles CA", "Austin TX"),
                        mode = "driving",
                        dep_date = "2023-07-30",
                        dep_time = "20:40:00",
                        traffic_model = "pessimistic",
                        shape = "long",
                        key=APIkey)
results
## $Distance
##              or             de Distance
## 1 Washington DC Los Angeles CA  4295065
## 2   New York NY Los Angeles CA  4489073
## 3 Washington DC      Austin TX  2451874
## 4   New York NY      Austin TX  2803934
## 
## $Time
##              or             de   Time
## 1 Washington DC Los Angeles CA 140478
## 2   New York NY Los Angeles CA 148456
## 3 Washington DC      Austin TX  81370
## 4   New York NY      Austin TX  94830
## 
## $Status
##              or             de status
## 1 Washington DC Los Angeles CA     OK
## 2   New York NY Los Angeles CA     OK
## 3 Washington DC      Austin TX     OK
## 4   New York NY      Austin TX     OK

# Time and distance avoiding 'tolls'.
results = gmapsdistance(origin = c("Washington DC", "New York NY"),
                        destination = c("Los Angeles CA", "Austin TX"),
                        mode = "driving",
                        avoid = "tolls",
                        key=APIkey)

results
## $Distance
##               Los Angeles CA Austin TX
## Washington DC        4303483   2460350
## New York NY          4607603   2800819
## 
## $Time
##               Los Angeles CA Austin TX
## Washington DC         140838     81763
## New York NY           153457     95391
## 
## $Status
##               Los Angeles CA Austin TX
## Washington DC "OK"           "OK"     
## New York NY   "OK"           "OK"
```

## Using "foreign" place names
It is perfectly possible to use names in non-ASCII characters; care must be however made that all characters are encoded in UTF-8 though. This may not be the obvious first choice of encoding, especially in Windows environments.


```r
results = gmapsdistance(origin = "вулиця Хрещатик, Київ",
                        destination = "Майдан Незалежності, Київ",
                        mode = "walking")
results
## $Distance
## [1] 596
## 
## $Time
## [1] 471
## 
## $Status
## [1] "OK"
```
