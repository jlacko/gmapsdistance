---
title: "gmapsdistance package in use"
author: "Jindra Lacko"
date: "2022-04-16"
output:
  rmarkdown::html_vignette:
    toc: true
self_contained: no
vignette: >
  %\VignetteIndexEntry{Examples of using `{gmapsdistance}` package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---



## Setting up API key
The [Google Distance Matrix API](https://mapsplatform.google.com/) requires registration, and an API key is required in each function call. It is possible to store the key for duration of a R session by using `gmapsdistance::set.api.key()` call.

Note that in order to keep the maintainers API key private it has been stored locally in an environment variable; in the most frequent use cases it can be used in plain text.


```r
library(gmapsdistance)
set.api.key(Sys.getenv("GOOGLE_API_KEY"))
```

## Distance between cities
In this example we will compute the driving distance between Washington DC, and New York City. The code returns the `Time`, the `Distance` and the `Status` of the query (`OK` if it was successful). The calculation will be made using the "driving" method, which is the default.


```r
results = gmapsdistance(origin = "Washington DC",
                        destination = "New York City NY")
results
## $Distance
## [1] 361947
## 
## $Time
## [1] 14145
## 
## $Status
## [1] "OK"
```

## Walking distance between GPS coordinates
In this example we will compute the driving distance between the Greek cities of
Marathon and Athens. We show that the function is able to handle LAT-LONG coordinates.


```r
results = gmapsdistance(origin = "38.1621328 24.0029257",
                        destination = "37.9908372 23.7383394",
                        mode = "walking")
results
## $Distance
## [1] 39461
## 
## $Time
## [1] 30024
## 
## $Status
## [1] "OK"
```

## Distance matrix at a specific departure time
This example computes the travel distance and time matrices between two vectors of cities at a specific departure time

```r
results = gmapsdistance(origin = c("Washington DC", "New York NY",
                                   "Seattle WA", "Miami FL"),
                        destination = c("Los Angeles CA", "Austin TX",
                                        "Chicago IL", "Philadelphia PA"),
                        mode = "bicycling",
                        # departure time as seconds from Unix Epoch (1970-01-01)
                        departure = 1660682400)
results
## $Distance
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC        4522001   2665898    1247092          229701
## New York NY          4863938   3155049    1472649          159373
## Seattle WA           1970537   3611546    3515251         4848182
## Miami FL             4548056   2316043    2354834         2139122
## 
## $Time
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC         843393    505495     243025           45679
## New York NY           910619    601416     291154           31514
## Seattle WA            366885    664120     651979          914279
## Miami FL              824233    420897     438437          396646
## 
## $Status
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC "OK"           "OK"      "OK"       "OK"           
## New York NY   "OK"           "OK"      "OK"       "OK"           
## Seattle WA    "OK"           "OK"      "OK"       "OK"           
## Miami FL      "OK"           "OK"      "OK"       "OK"
# Equivalently
results = gmapsdistance(origin = c("Washington DC", "New York NY",
                                   "Seattle WA", "Miami FL"),
                        destination = c("Los Angeles CA", "Austin TX",
                                        "Chicago IL", "Philadelphia PA"),
                        mode = "bicycling",
                        dep_date = "2022-08-16",
                        dep_time = "20:40:00")

results
## $Distance
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC        4522001   2665898    1247092          229701
## New York NY          4863938   3155049    1472649          159373
## Seattle WA           1970537   3611546    3515251         4848182
## Miami FL             4548056   2316043    2354834         2139122
## 
## $Time
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC         843393    505495     243025           45679
## New York NY           910619    601416     291154           31514
## Seattle WA            366885    664120     651979          914279
## Miami FL              824233    420897     438437          396646
## 
## $Status
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC "OK"           "OK"      "OK"       "OK"           
## New York NY   "OK"           "OK"      "OK"       "OK"           
## Seattle WA    "OK"           "OK"      "OK"       "OK"           
## Miami FL      "OK"           "OK"      "OK"       "OK"
```

## Long format of distance matrix
This example computes the travel distance and time matrices between two vectors of cities and return the results in long format

```r
origin = c("Washington DC", "New York NY", "Seattle WA", "Miami FL")
destination = c("Los Angeles CA", "Austin TX", "Chicago IL")

results = gmapsdistance(origin,
                        destination,
                        mode = "driving",
                        shape = "long")

results
## $Distance
##               or             de Distance
## 1  Washington DC Los Angeles CA  4294773
## 2    New York NY Los Angeles CA  4488878
## 3     Seattle WA Los Angeles CA  1829053
## 4       Miami FL Los Angeles CA  4398251
## 5  Washington DC      Austin TX  2450835
## 6    New York NY      Austin TX  2802960
## 7     Seattle WA      Austin TX  3410100
## 8       Miami FL      Austin TX  2171409
## 9  Washington DC     Chicago IL  1126229
## 10   New York NY     Chicago IL  1271486
## 11    Seattle WA     Chicago IL  3288656
## 12      Miami FL     Chicago IL  2226506
## 
## $Time
##               or             de   Time
## 1  Washington DC Los Angeles CA 141328
## 2    New York NY Los Angeles CA 149634
## 3     Seattle WA Los Angeles CA  63557
## 4       Miami FL Los Angeles CA 143309
## 5  Washington DC      Austin TX  81782
## 6    New York NY      Austin TX  94406
## 7     Seattle WA      Austin TX 118502
## 8       Miami FL      Austin TX  71650
## 9  Washington DC     Chicago IL  39023
## 10   New York NY     Chicago IL  44040
## 11    Seattle WA     Chicago IL 109489
## 12      Miami FL     Chicago IL  72328
## 
## $Status
##               or             de status
## 1  Washington DC Los Angeles CA     OK
## 2    New York NY Los Angeles CA     OK
## 3     Seattle WA Los Angeles CA     OK
## 4       Miami FL Los Angeles CA     OK
## 5  Washington DC      Austin TX     OK
## 6    New York NY      Austin TX     OK
## 7     Seattle WA      Austin TX     OK
## 8       Miami FL      Austin TX     OK
## 9  Washington DC     Chicago IL     OK
## 10   New York NY     Chicago IL     OK
## 11    Seattle WA     Chicago IL     OK
## 12      Miami FL     Chicago IL     OK
```

## Distance matrix between GPS coordinates
This example computes the travel distance and time between two vectors of cities. This example shows that the function is able to handle LAT-LONG coordinates and a Google Maps API Key


```r
origin = c("40.431478 -80.0505401", "33.7678359 -84.4906438")
destination = c("43.0995629 -79.0437609", "41.7096483 -86.9093986")

results = gmapsdistance(origin,
                        destination,
                        mode="bicycling",
                        shape="long")

results
## $Distance
##                       or                     de Distance
## 1  40.431478 -80.0505401 43.0995629 -79.0437609   419316
## 2 33.7678359 -84.4906438 43.0995629 -79.0437609  1530679
## 3  40.431478 -80.0505401 41.7096483 -86.9093986   702490
## 4 33.7678359 -84.4906438 41.7096483 -86.9093986  1112200
## 
## $Time
##                       or                     de   Time
## 1  40.431478 -80.0505401 43.0995629 -79.0437609  79240
## 2 33.7678359 -84.4906438 43.0995629 -79.0437609 290455
## 3  40.431478 -80.0505401 41.7096483 -86.9093986 131837
## 4 33.7678359 -84.4906438 41.7096483 -86.9093986 209147
## 
## $Status
##                       or                     de status
## 1  40.431478 -80.0505401 43.0995629 -79.0437609     OK
## 2 33.7678359 -84.4906438 43.0995629 -79.0437609     OK
## 3  40.431478 -80.0505401 41.7096483 -86.9093986     OK
## 4 33.7678359 -84.4906438 41.7096483 -86.9093986     OK
```

## Combination of distances
This example computes the travel distance and time between two vectors of cities using the 'combinations' option.


```r
# 1. Pairwise

or = c("Washington DC", "New York NY", "Seattle WA", "Miami FL")
des = c("Los Angeles CA", "Austin TX", "Chicago IL", "Philadelphia PA")

results = gmapsdistance(origin = or,
                        destination = des,
                        mode = "bicycling",
                        combinations = "pairwise")
results
## $Distance
##              or              de Distance
## 1 Washington DC  Los Angeles CA  4522001
## 2   New York NY       Austin TX  3155049
## 3    Seattle WA      Chicago IL  3515251
## 4      Miami FL Philadelphia PA  2139122
## 
## $Time
##              or              de   Time
## 1 Washington DC  Los Angeles CA 843393
## 2   New York NY       Austin TX 601416
## 3    Seattle WA      Chicago IL 651979
## 4      Miami FL Philadelphia PA 396646
## 
## $Status
##              or              de status
## 1 Washington DC  Los Angeles CA     OK
## 2   New York NY       Austin TX     OK
## 3    Seattle WA      Chicago IL     OK
## 4      Miami FL Philadelphia PA     OK

# 2. All combinations of origins and destinations in wide format
results = gmapsdistance(origin = or,
                        destination = des,
                        mode = "bicycling",
                        combinations = "all",
                        shape = "wide")
results
## $Distance
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC        4522001   2665898    1247092          229701
## New York NY          4863938   3155049    1472649          159373
## Seattle WA           1970537   3611546    3515251         4848182
## Miami FL             4548056   2316043    2354834         2139122
## 
## $Time
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC         843393    505495     243025           45679
## New York NY           910619    601416     291154           31514
## Seattle WA            366885    664120     651979          914279
## Miami FL              824233    420897     438437          396646
## 
## $Status
##               Los Angeles CA Austin TX Chicago IL Philadelphia PA
## Washington DC "OK"           "OK"      "OK"       "OK"           
## New York NY   "OK"           "OK"      "OK"       "OK"           
## Seattle WA    "OK"           "OK"      "OK"       "OK"           
## Miami FL      "OK"           "OK"      "OK"       "OK"

results = gmapsdistance(origin = or,
                        destination = des,
                        mode = "bicycling",
                        combinations = "all",
                        shape = "long")
results
## $Distance
##               or              de Distance
## 1  Washington DC  Los Angeles CA  4522001
## 2    New York NY  Los Angeles CA  4863938
## 3     Seattle WA  Los Angeles CA  1970537
## 4       Miami FL  Los Angeles CA  4548056
## 5  Washington DC       Austin TX  2665898
## 6    New York NY       Austin TX  3155049
## 7     Seattle WA       Austin TX  3611546
## 8       Miami FL       Austin TX  2316043
## 9  Washington DC      Chicago IL  1247092
## 10   New York NY      Chicago IL  1472649
## 11    Seattle WA      Chicago IL  3515251
## 12      Miami FL      Chicago IL  2354834
## 13 Washington DC Philadelphia PA   229701
## 14   New York NY Philadelphia PA   159373
## 15    Seattle WA Philadelphia PA  4848182
## 16      Miami FL Philadelphia PA  2139122
## 
## $Time
##               or              de   Time
## 1  Washington DC  Los Angeles CA 843393
## 2    New York NY  Los Angeles CA 910619
## 3     Seattle WA  Los Angeles CA 366885
## 4       Miami FL  Los Angeles CA 824233
## 5  Washington DC       Austin TX 505495
## 6    New York NY       Austin TX 601416
## 7     Seattle WA       Austin TX 664120
## 8       Miami FL       Austin TX 420897
## 9  Washington DC      Chicago IL 243025
## 10   New York NY      Chicago IL 291154
## 11    Seattle WA      Chicago IL 651979
## 12      Miami FL      Chicago IL 438437
## 13 Washington DC Philadelphia PA  45679
## 14   New York NY Philadelphia PA  31514
## 15    Seattle WA Philadelphia PA 914279
## 16      Miami FL Philadelphia PA 396646
## 
## $Status
##               or              de status
## 1  Washington DC  Los Angeles CA     OK
## 2    New York NY  Los Angeles CA     OK
## 3     Seattle WA  Los Angeles CA     OK
## 4       Miami FL  Los Angeles CA     OK
## 5  Washington DC       Austin TX     OK
## 6    New York NY       Austin TX     OK
## 7     Seattle WA       Austin TX     OK
## 8       Miami FL       Austin TX     OK
## 9  Washington DC      Chicago IL     OK
## 10   New York NY      Chicago IL     OK
## 11    Seattle WA      Chicago IL     OK
## 12      Miami FL      Chicago IL     OK
## 13 Washington DC Philadelphia PA     OK
## 14   New York NY Philadelphia PA     OK
## 15    Seattle WA Philadelphia PA     OK
## 16      Miami FL Philadelphia PA     OK
```

## Using optional parameters - traffic model and avoidance
This example show the use of traffic model and avoidance parameters, while setting the API key directly in function call.
Note that in order to keep the maintainers API key private it has been stored locally in an environment variable; in the most frequent use cases it can be used in plain text.


```r
APIkey <- Sys.getenv("GOOGLE_API_KEY") # your actual API key would go here...

# Time and distance using a 'pessimistic' traffic model.
results = gmapsdistance(origin = c("Washington DC", "New York NY"),
                        destination = c("Los Angeles CA", "Austin TX"),
                        mode = "driving",
                        dep_date = "2022-08-16",
                        dep_time = "20:40:00",
                        traffic_model = "pessimistic",
                        shape = "long",
                        key=APIkey)
results
## $Distance
##              or             de Distance
## 1 Washington DC Los Angeles CA  4294773
## 2   New York NY Los Angeles CA  4488878
## 3 Washington DC      Austin TX  2451918
## 4   New York NY      Austin TX  2804044
## 
## $Time
##              or             de   Time
## 1 Washington DC Los Angeles CA 141328
## 2   New York NY Los Angeles CA 149634
## 3 Washington DC      Austin TX  81746
## 4   New York NY      Austin TX  94370
## 
## $Status
##              or             de status
## 1 Washington DC Los Angeles CA     OK
## 2   New York NY Los Angeles CA     OK
## 3 Washington DC      Austin TX     OK
## 4   New York NY      Austin TX     OK

# Time and distance avoiding 'tolls'.
results = gmapsdistance(origin = c("Washington DC", "New York NY"),
                        destination = c("Los Angeles CA", "Austin TX"),
                        mode = "driving",
                        avoid = "tolls",
                        key=APIkey)

results
## $Distance
##               Los Angeles CA Austin TX
## Washington DC        4303249   2459310
## New York NY          4514463   2799797
## 
## $Time
##               Los Angeles CA Austin TX
## Washington DC         141736     82190
## New York NY           153823     94942
## 
## $Status
##               Los Angeles CA Austin TX
## Washington DC "OK"           "OK"     
## New York NY   "OK"           "OK"
```

## Using "foreign" place names
It is perfectly possible to use names in non-ASCII characters; care must be however made that all characters are encoded in UTF-8 though. This may not be the obvious first choice of encoding, especially in Windows environments.


```r
results = gmapsdistance(origin = "вулиця Хрещатик, Київ",
                        destination = "Майдан Незалежності, Київ",
                        mode = "walking")
results
## $Distance
## [1] 596
## 
## $Time
## [1] 469
## 
## $Status
## [1] "OK"
```
